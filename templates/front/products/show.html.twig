{% extends 'layouts/user.html.twig' %}

{% block title %}{{ produit.nom }} - AutiCare{% endblock %}

{% block user_content %}
{% for message in app.flashes('error') %}
    <div class="mb-4 px-4 py-3 rounded-lg bg-red-50 border border-red-200 text-red-800">{{ message }}</div>
{% endfor %}
<a href="{{ path('user_products_index') }}" class="inline-flex items-center gap-2 text-[#6B7280] hover:text-[#A7C7E7] mb-6 focus:outline focus:ring-2 focus:ring-[#A7C7E7] rounded">
    <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M10 19l-7-7m0 0l7-7m-7 7h18" /></svg>
    Retour aux produits
</a>

<div class="flex flex-col lg:flex-row gap-8 lg:gap-12 mb-12">
    <div class="lg:w-1/2 space-y-4">
        <div class="aspect-square bg-[#F5F1EB] rounded-2xl flex items-center justify-center text-[#6B7280] overflow-hidden">
            {% if produit.image %}
                <img src="{{ asset(produit.image) }}" alt="{{ produit.nom }}" class="w-full h-full object-cover">
            {% else %}
                <span>Pas d'image</span>
            {% endif %}
        </div>
    </div>

    <div class="lg:w-1/2">
        <span class="inline-block px-2 py-1 rounded text-xs font-medium text-white bg-[#A7C7E7]">{{ produit.categorie ? produit.categorie.label : '—' }}</span>
        <h1 class="text-2xl md:text-3xl font-bold text-[#4B5563] mt-3 mb-2">{{ produit.nom }}</h1>
        <p class="text-xl font-semibold text-[#A7C7E7] mb-4">{{ produit.prix|number_format(2, ',', ' ') }} د.ت</p>
        <p class="inline-flex px-2 py-1 rounded text-xs font-medium {% if produit.disponibilite %}bg-emerald-100 text-emerald-800{% else %}bg-red-100 text-red-800{% endif %} mb-4">
            {{ produit.disponibilite ? 'Disponible' : 'Indisponible' }}
        </p>
        {% if produit.description %}
        <p class="text-[#6B7280] mb-6 whitespace-pre-line">{{ produit.description }}</p>
        {% endif %}

        <div class="flex flex-wrap items-center gap-3 mb-8">
            {% if produit.disponibilite and app.user %}
            <form method="POST" action="{{ path('cart_add', { id: produit.id }) }}" class="inline">
                <input type="hidden" name="_token" value="{{ csrf_token('cart_add_' ~ produit.id) }}">
                <button type="submit" class="inline-flex items-center gap-2 px-6 py-3 rounded-lg bg-[#A7C7E7] text-white font-medium hover:bg-[#B8D4ED] focus:outline focus:ring-2 focus:ring-[#A7C7E7]">
                    <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 10.5V6a3.75 3.75 0 10-7.5 0v4.5m11.356-1.993l1.263 12c.07.665-.45 1.243-1.119 1.243H4.25a1.125 1.125 0 01-1.12-1.243l1.264-12A1.125 1.125 0 015.513 7.5h12.974c.576 0 1.059.435 1.119 1.007zM8.625 10.5a.375.375 0 11-.75 0 .375.375 0 01.75 0zm7.5 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z" /></svg>
                    Ajouter au panier
                </button>
            </form>
            {% elseif produit.disponibilite %}
            <p class="text-sm text-[#6B7280]">Connectez-vous pour ajouter ce produit au panier.</p>
            {% endif %}
        </div>

        <div class="flex flex-wrap gap-6 text-sm text-[#6B7280]">
            <span class="flex items-center gap-2"><svg class="w-5 h-5 text-[#A7C7E7]" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M8.25 18.75L12 15.75m0 0l3.75 3M12 15.75V2.25" /></svg> Livraison gratuite</span>
            <span class="flex items-center gap-2"><svg class="w-5 h-5 text-[#A7C7E7]" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75m-3-7.036A11.959 11.959 0 013.598 6 11.99 11.99 0 003 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285z" /></svg> Paiement sécurisé</span>
        </div>
    </div>
</div>
{% endblock %}
