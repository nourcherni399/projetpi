{% extends 'layouts/admin.html.twig' %}

{% block title %}Utilisateur {{ user.nom }} {{ user.prenom }} - AutiCare Admin{% endblock %}

{% block admin_content %}
<div class="max-w-4xl">
    <div class="mb-6 flex items-center gap-4 flex-wrap">
        <a href="{{ path('admin_users') }}" class="inline-flex items-center gap-2 text-[#6B7280] hover:text-[#A7C7E7] focus:outline focus:ring-2 focus:ring-[#A7C7E7] rounded-lg transition-colors">
            <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M10 19l-7-7m0 0l7-7m-7 7h18" /></svg>
            Retour à la liste
        </a>
        <a href="{{ path('admin_user_edit', { id: user.id }) }}" class="inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-[#A7C7E7] text-white font-medium hover:bg-[#B8D4ED] focus:outline focus:ring-2 focus:ring-[#A7C7E7] shadow-sm transition-colors">
            <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" /></svg>
            Modifier
        </a>
        <a href="{{ path('admin_user_confirm_delete', { id: user.id }) }}" class="inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-red-100 text-red-600 font-medium hover:bg-red-200 border border-red-200 focus:outline focus:ring-2 focus:ring-red-500 transition-colors">
            <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" /></svg>
            Supprimer
        </a>
    </div>

    {# En-tête profil #}
    <div class="bg-white rounded-xl border border-[#E5E0D8] overflow-hidden shadow-sm mb-6">
        <div class="p-6 bg-gradient-to-r from-[#F5F1EB] via-white to-[#F5F1EB] border-b border-[#E5E0D8]">
            <div class="flex flex-wrap items-center gap-3">
                <div class="flex items-center justify-center w-14 h-14 rounded-full overflow-hidden bg-[#A7C7E7] text-white text-xl font-bold shadow-sm shrink-0">
                    {% if user.image %}
                        <img src="{{ asset(user.image) }}" alt="{{ user.prenom }} {{ user.nom }}" class="w-full h-full object-cover">
                    {% else %}
                        {{ user.prenom|slice(0,1)|upper }}{{ user.nom|slice(0,1)|upper }}
                    {% endif %}
                </div>
                <div>
                    <h1 class="text-2xl font-semibold text-[#4B5563]">{{ user.prenom }} {{ user.nom }}</h1>
                    <p class="text-[#6B7280] text-sm mt-0.5">{{ user.email }}</p>
                    {% set roleValue = user.role ? user.role.value : '' %}
                    <span class="inline-flex mt-2 px-2.5 py-1 rounded-lg text-xs font-semibold
                        {% if roleValue == 'ROLE_ADMIN' %}bg-blue-100 text-blue-800
                        {% elseif roleValue == 'ROLE_MEDECIN' %}bg-teal-100 text-teal-800
                        {% elseif roleValue == 'ROLE_PATIENT' or roleValue == 'ROLE_USER' %}bg-violet-100 text-violet-800
                        {% elseif roleValue == 'ROLE_PARENT' %}bg-amber-100 text-amber-800
                        {% else %}bg-slate-100 text-slate-700{% endif %}">
                        {{ roleValue ? roleValue|replace({'ROLE_': ''}) : '—' }}
                    </span>
                    {% if user.isActive %}
                    <span class="inline-flex ml-2 mt-2 px-2.5 py-1 rounded-lg text-xs font-semibold bg-emerald-100 text-emerald-800">Actif</span>
                    {% else %}
                    <span class="inline-flex ml-2 mt-2 px-2.5 py-1 rounded-lg text-xs font-semibold bg-slate-100 text-slate-600">Inactif</span>
                    {% endif %}
                </div>
            </div>
        </div>

        {# Infos en grille type cartes #}
        <div class="p-6">
            <h2 class="text-sm font-semibold text-[#4B5563] uppercase tracking-wide mb-4 flex items-center gap-2">
                <span class="w-1 h-5 rounded-full bg-[#A7C7E7]"></span>
                Informations générales
            </h2>
            <dl class="grid grid-cols-1 sm:grid-cols-2 gap-x-6 gap-y-4">
                <div class="flex justify-between sm:block gap-2 py-2 border-b border-[#E5E0D8]/80">
                    <dt class="text-sm font-medium text-[#6B7280]">Id</dt>
                    <dd class="text-[#4B5563] font-medium">{{ user.id }}</dd>
                </div>
                <div class="flex justify-between sm:block gap-2 py-2 border-b border-[#E5E0D8]/80">
                    <dt class="text-sm font-medium text-[#6B7280]">Nom</dt>
                    <dd class="text-[#4B5563] font-medium">{{ user.nom }}</dd>
                </div>
                <div class="flex justify-between sm:block gap-2 py-2 border-b border-[#E5E0D8]/80">
                    <dt class="text-sm font-medium text-[#6B7280]">Prénom</dt>
                    <dd class="text-[#4B5563] font-medium">{{ user.prenom }}</dd>
                </div>
                <div class="flex justify-between sm:block gap-2 py-2 border-b border-[#E5E0D8]/80">
                    <dt class="text-sm font-medium text-[#6B7280]">Email</dt>
                    <dd class="text-[#4B5563]">{{ user.email }}</dd>
                </div>
                <div class="flex justify-between sm:block gap-2 py-2 border-b border-[#E5E0D8]/80">
                    <dt class="text-sm font-medium text-[#6B7280]">Téléphone</dt>
                    <dd class="text-[#4B5563]">{{ user.telephone ?? '—' }}</dd>
                </div>
                <div class="flex justify-between sm:block gap-2 py-2 border-b border-[#E5E0D8]/80">
                    <dt class="text-sm font-medium text-[#6B7280]">Actif</dt>
                    <dd>{% if user.isActive %}<span class="inline-flex px-2 py-0.5 rounded text-xs font-medium bg-emerald-100 text-emerald-800">Oui</span>{% else %}<span class="inline-flex px-2 py-0.5 rounded text-xs font-medium bg-slate-100 text-slate-600">Non</span>{% endif %}</dd>
                </div>
                <div class="flex justify-between sm:block gap-2 py-2 border-b border-[#E5E0D8]/80">
                    <dt class="text-sm font-medium text-[#6B7280]">Créé le</dt>
                    <dd class="text-[#4B5563]">{{ user.createdAt ? user.createdAt|date('d/m/Y H:i') : '—' }}</dd>
                </div>
                <div class="flex justify-between sm:block gap-2 py-2 border-b border-[#E5E0D8]/80">
                    <dt class="text-sm font-medium text-[#6B7280]">Mis à jour le</dt>
                    <dd class="text-[#4B5563]">{{ user.updatedAt ? user.updatedAt|date('d/m/Y H:i') : '—' }}</dd>
                </div>
            </dl>
        </div>

        {% if userType is defined and userType == 'medcin' %}
        <div class="p-6 border-t border-[#E5E0D8] bg-gradient-to-r from-teal-50/50 to-white">
            <h2 class="text-sm font-semibold text-[#4B5563] uppercase tracking-wide mb-4 flex items-center gap-2">
                <span class="w-1 h-5 rounded-full bg-teal-500"></span>
                Attributs médecin
            </h2>
            <dl class="grid grid-cols-1 sm:grid-cols-2 gap-x-6 gap-y-4">
                <div class="flex justify-between sm:block gap-2 py-2 border-b border-[#E5E0D8]/80"><dt class="text-sm font-medium text-[#6B7280]">Spécialité</dt><dd class="text-[#4B5563]">{{ user.specialite ?? '—' }}</dd></div>
                <div class="flex justify-between sm:block gap-2 py-2 border-b border-[#E5E0D8]/80"><dt class="text-sm font-medium text-[#6B7280]">Nom du cabinet</dt><dd class="text-[#4B5563]">{{ user.nomCabinet ?? '—' }}</dd></div>
                <div class="sm:col-span-2 flex justify-between sm:block gap-2 py-2 border-b border-[#E5E0D8]/80"><dt class="text-sm font-medium text-[#6B7280]">Adresse du cabinet</dt><dd class="text-[#4B5563]">{{ user.adresseCabinet ?? '—' }}</dd></div>
                <div class="flex justify-between sm:block gap-2 py-2 border-b border-[#E5E0D8]/80"><dt class="text-sm font-medium text-[#6B7280]">Téléphone du cabinet</dt><dd class="text-[#4B5563]">{{ user.telephoneCabinet ?? '—' }}</dd></div>
                <div class="flex justify-between sm:block gap-2 py-2 border-b border-[#E5E0D8]/80"><dt class="text-sm font-medium text-[#6B7280]">Tarif consultation (DT)</dt><dd class="text-[#4B5563] font-medium">{{ user.tarifConsultation ?? '—' }}</dd></div>
            </dl>
        </div>
        {% endif %}

        {% if userType is defined and userType == 'parent' %}
        <div class="p-6 border-t border-[#E5E0D8] bg-gradient-to-r from-amber-50/50 to-white">
            <h2 class="text-sm font-semibold text-[#4B5563] uppercase tracking-wide mb-4 flex items-center gap-2">
                <span class="w-1 h-5 rounded-full bg-amber-500"></span>
                Attributs parent
            </h2>
            <dl class="grid grid-cols-1 gap-y-4">
                <div class="flex justify-between sm:block gap-2 py-2 border-b border-[#E5E0D8]/80"><dt class="text-sm font-medium text-[#6B7280]">Relation avec le patient</dt><dd class="text-[#4B5563]">{{ user.relationAvecPatient ?? '—' }}</dd></div>
            </dl>
        </div>
        {% endif %}

        {% if userType is defined and userType == 'patient' %}
        <div class="p-6 border-t border-[#E5E0D8] bg-gradient-to-r from-violet-50/50 to-white">
            <h2 class="text-sm font-semibold text-[#4B5563] uppercase tracking-wide mb-4 flex items-center gap-2">
                <span class="w-1 h-5 rounded-full bg-violet-500"></span>
                Attributs patient
            </h2>
            <dl class="grid grid-cols-1 sm:grid-cols-2 gap-x-6 gap-y-4">
                <div class="flex justify-between sm:block gap-2 py-2 border-b border-[#E5E0D8]/80"><dt class="text-sm font-medium text-[#6B7280]">Date de naissance</dt><dd class="text-[#4B5563]">{{ user.dateNaissance ? user.dateNaissance|date('d/m/Y') : '—' }}</dd></div>
                <div class="flex justify-between sm:block gap-2 py-2 border-b border-[#E5E0D8]/80"><dt class="text-sm font-medium text-[#6B7280]">Sexe</dt><dd class="text-[#4B5563]">{{ user.sexe ? user.sexe.value : '—' }}</dd></div>
                <div class="sm:col-span-2 flex justify-between sm:block gap-2 py-2 border-b border-[#E5E0D8]/80"><dt class="text-sm font-medium text-[#6B7280]">Adresse</dt><dd class="text-[#4B5563]">{{ user.adresse ?? '—' }}</dd></div>
            </dl>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}
